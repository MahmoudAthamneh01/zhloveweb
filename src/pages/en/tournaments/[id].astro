---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import TournamentBracket from '../../../components/tournaments/TournamentBracket';
import TournamentUpdates from '../../../components/tournaments/TournamentUpdates';
import TournamentManagement from '../../../components/tournaments/TournamentManagement';
---

<BaseLayout 
  title="Tournament Details - ZH-Love"
  description="Tournament details and information in ZH-Love community"
>
  <div class="min-h-screen bg-background">
    <!-- Tournament Header -->
    <div id="tournament-header" class="relative bg-gradient-to-r from-gray-900 via-green-900 to-gray-900 py-16">
      <div class="absolute inset-0 bg-black opacity-50"></div>
      <div class="relative container mx-auto px-4">
        <!-- Loading State -->
        <div id="header-loading" class="text-center">
          <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto mb-4"></div>
          <p class="text-gray-400">Loading tournament...</p>
        </div>
        
        <!-- Tournament Header Content (Will be populated by JS) -->
        <div id="header-content" class="hidden">
          <!-- Content will be inserted here -->
        </div>
      </div>
    </div>

    <div class="container mx-auto px-4 py-8">
      <!-- Tournament Navigation -->
      <div class="bg-card border border-border rounded-lg p-1 mb-8 inline-flex">
        <button 
          id="tab-overview" 
          class="tab-button px-6 py-3 rounded-md text-sm font-medium transition-colors active"
          data-tab="overview"
        >
          Overview
        </button>
        <button 
          id="tab-bracket" 
          class="tab-button px-6 py-3 rounded-md text-sm font-medium transition-colors"
          data-tab="bracket"
        >
          Bracket
        </button>
        <button 
          id="tab-participants" 
          class="tab-button px-6 py-3 rounded-md text-sm font-medium transition-colors"
          data-tab="participants"
        >
          Participants
        </button>
        <button 
          id="tab-updates" 
          class="tab-button px-6 py-3 rounded-md text-sm font-medium transition-colors"
          data-tab="updates"
        >
          Updates
        </button>
        <button 
          id="tab-management" 
          class="tab-button px-6 py-3 rounded-md text-sm font-medium transition-colors hidden"
          data-tab="management"
        >
          Management
        </button>
      </div>

      <!-- Tab Content -->
      <div id="tab-content">
        <!-- Overview Tab -->
        <div id="content-overview" class="tab-content">
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Main Info -->
            <div class="lg:col-span-2 space-y-6">
              <!-- Tournament Description -->
              <div class="bg-card border border-border rounded-lg p-6">
                <h2 class="text-xl font-semibold text-white mb-4">Tournament Description</h2>
                <div id="tournament-description" class="text-gray-300 leading-relaxed">
                  Loading...
                </div>
              </div>

              <!-- Tournament Rules -->
              <div class="bg-card border border-border rounded-lg p-6">
                <h2 class="text-xl font-semibold text-white mb-4">Tournament Rules</h2>
                <div id="tournament-rules" class="text-gray-300 leading-relaxed whitespace-pre-line">
                  Loading...
                </div>
              </div>

              <!-- Maps -->
              <div class="bg-card border border-border rounded-lg p-6">
                <h2 class="text-xl font-semibold text-white mb-4">Allowed Maps</h2>
                <div id="tournament-maps" class="grid grid-cols-2 md:grid-cols-3 gap-3">
                  <!-- Maps will be loaded here -->
                </div>
              </div>

              <!-- Prizes -->
              <div id="prizes-section" class="bg-card border border-border rounded-lg p-6">
                <h2 class="text-xl font-semibold text-white mb-4">Prize Distribution</h2>
                <div id="prize-distribution">
                  <!-- Prize distribution will be loaded here -->
                </div>
              </div>
            </div>

            <!-- Sidebar -->
            <div class="space-y-6">
              <!-- Quick Info -->
              <div class="bg-card border border-border rounded-lg p-6">
                <h3 class="text-lg font-semibold text-white mb-4">Quick Info</h3>
                <div id="quick-info" class="space-y-3">
                  <!-- Quick info will be loaded here -->
                </div>
              </div>

              <!-- Tournament Status -->
              <div class="bg-card border border-border rounded-lg p-6">
                <h3 class="text-lg font-semibold text-white mb-4">Tournament Status</h3>
                <div id="tournament-status">
                  <!-- Status info will be loaded here -->
                </div>
              </div>

              <!-- Contact Info -->
              <div id="contact-section" class="bg-card border border-border rounded-lg p-6">
                <h3 class="text-lg font-semibold text-white mb-4">Contact</h3>
                <div id="contact-info">
                  <!-- Contact info will be loaded here -->
                </div>
              </div>

              <!-- Action Buttons -->
              <div id="action-buttons" class="space-y-3">
                <!-- Action buttons will be loaded here -->
              </div>
            </div>
          </div>
        </div>

        <!-- Bracket Tab -->
        <div id="content-bracket" class="tab-content hidden">
          <TournamentBracket client:load />
        </div>

        <!-- Participants Tab -->
        <div id="content-participants" class="tab-content hidden">
          <div class="bg-card border border-border rounded-lg p-6">
            <div class="flex items-center justify-between mb-6">
              <h2 class="text-xl font-semibold text-white">Participants</h2>
              <div class="flex items-center space-x-4">
                <span id="participant-count" class="text-gray-400">0 participants</span>
                <button id="export-participants" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm">
                  Export List
                </button>
              </div>
            </div>
            
            <div id="participants-list">
              <!-- Participants list will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Updates Tab -->
        <div id="content-updates" class="tab-content hidden">
          <TournamentUpdates client:load />
        </div>

        <!-- Management Tab -->
        <div id="content-management" class="tab-content hidden">
          <TournamentManagement client:load />
        </div>
      </div>
    </div>
  </div>

  <script>
    // Same JavaScript as Arabic version but with English text
    document.addEventListener('DOMContentLoaded', function() {
      const tournamentId = window.location.pathname.split('/').pop();
      let tournament = null;
      let currentUser = null;
      let isOrganizer = false;
      let isAdmin = false;

      // Same initialization and functions as Arabic version
      // but with English text labels and formatting
      
      function getStatusText(status) {
        switch (status) {
          case 'open': return 'Open for Registration';
          case 'live': return 'Live Now';
          case 'completed': return 'Completed';
          case 'upcoming': return 'Upcoming';
          case 'cancelled': return 'Cancelled';
          default: return 'Unknown';
        }
      }

      // Rest of the JavaScript remains the same...
    });
  </script>

  <style>
    /* Same styles as Arabic version */
    .tab-button {
      color: rgb(156 163 175);
    }

    .tab-button:hover {
      color: rgb(255 255 255);
      background-color: rgb(55 65 81);
    }

    .tab-button.active {
      color: rgb(255 255 255);
      background-color: rgb(34 197 94);
    }

    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fade-in 0.3s ease-out;
    }
  </style>
</BaseLayout> 