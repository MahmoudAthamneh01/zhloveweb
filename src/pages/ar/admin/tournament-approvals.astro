---
import BaseLayout from '../../../layouts/BaseLayout.astro';
---

<BaseLayout 
  title="Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª - Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"
  description="Ø¥Ø¯Ø§Ø±Ø© Ù…ÙˆØ§ÙÙ‚Ø§Øª Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© ÙˆØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©"
>
  <div class="min-h-screen bg-background">
    <!-- Header -->
    <div class="bg-gradient-to-r from-orange-900 to-orange-800 py-8">
      <div class="container mx-auto px-4">
        <div class="flex items-center justify-between">
          <div>
            <h1 class="text-3xl font-bold text-white mb-2">Ù…ÙˆØ§ÙÙ‚Ø© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</h1>
            <p class="text-orange-200">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ù„Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙˆØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</p>
          </div>
          <div class="flex items-center space-x-4 rtl:space-x-reverse">
            <div class="bg-black bg-opacity-20 backdrop-blur-sm rounded-lg p-4 text-center">
              <div class="text-2xl font-bold text-white" id="pending-count">8</div>
              <div class="text-orange-200 text-sm">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
            </div>
            <div class="bg-black bg-opacity-20 backdrop-blur-sm rounded-lg p-4 text-center">
              <div class="text-2xl font-bold text-white" id="approved-today">12</div>
              <div class="text-orange-200 text-sm">Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§ Ø§Ù„ÙŠÙˆÙ…</div>
            </div>
            <div class="bg-black bg-opacity-20 backdrop-blur-sm rounded-lg p-4 text-center">
              <div class="text-2xl font-bold text-white" id="featured-count">3</div>
              <div class="text-orange-200 text-sm">Ù…Ù…ÙŠØ²Ø©</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container mx-auto px-4 py-8">
      <!-- Action Bar -->
      <div class="bg-card border border-border rounded-lg p-6 mb-8">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4">
          <div class="flex items-center space-x-4 rtl:space-x-reverse">
            <button id="bulk-approve" class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center space-x-2 rtl:space-x-reverse">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
              <span>Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ø¯Ø¯</span>
            </button>
            <button id="bulk-reject" class="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors flex items-center space-x-2 rtl:space-x-reverse">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
              </svg>
              <span>Ø±ÙØ¶ Ø§Ù„Ù…Ø­Ø¯Ø¯</span>
            </button>
            <button id="bulk-feature" class="px-6 py-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors flex items-center space-x-2 rtl:space-x-reverse">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
              </svg>
              <span>ØªÙ…ÙŠÙŠØ² Ø§Ù„Ù…Ø­Ø¯Ø¯</span>
            </button>
          </div>
          
          <div class="flex items-center space-x-4 rtl:space-x-reverse">
            <select id="status-filter" class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500">
              <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
              <option value="pending">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
              <option value="approved">Ù…ÙˆØ§ÙÙ‚ Ø¹Ù„ÙŠÙ‡Ø§</option>
              <option value="rejected">Ù…Ø±ÙÙˆØ¶Ø©</option>
              <option value="featured">Ù…Ù…ÙŠØ²Ø©</option>
            </select>
            <input 
              type="search" 
              id="search-tournaments" 
              placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª..."
              class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500"
            />
          </div>
        </div>
      </div>

      <!-- Tournaments List -->
      <div class="space-y-6" id="tournaments-list">
        <!-- Loading State -->
        <div class="text-center py-20">
          <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600 mb-4"></div>
          <p class="text-gray-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª...</p>
        </div>
      </div>

      <!-- Pagination -->
      <div id="pagination" class="flex justify-center mt-8 hidden">
        <nav class="flex items-center space-x-2 rtl:space-x-reverse">
          <button id="prev-page" class="px-4 py-2 bg-gray-800 text-gray-400 rounded-lg hover:bg-gray-700 hover:text-white transition-colors disabled:opacity-50">
            Ø§Ù„Ø³Ø§Ø¨Ù‚
          </button>
          <div id="page-numbers" class="flex space-x-2 rtl:space-x-reverse">
            <!-- Page numbers will be inserted here -->
          </div>
          <button id="next-page" class="px-4 py-2 bg-gray-800 text-gray-400 rounded-lg hover:bg-gray-700 hover:text-white transition-colors">
            Ø§Ù„ØªØ§Ù„ÙŠ
          </button>
        </nav>
      </div>
    </div>
  </div>

  <!-- Tournament Details Modal -->
  <div id="tournament-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
    <div class="bg-card border border-border rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6">
        <div class="flex items-center justify-between mb-6">
          <h3 id="modal-title" class="text-2xl font-bold text-white">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©</h3>
          <button id="close-modal" class="text-gray-400 hover:text-white transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <div id="modal-content">
          <!-- Tournament details will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Approval/Rejection Modal -->
  <div id="action-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
    <div class="bg-card border border-border rounded-lg max-w-md w-full">
      <div class="p-6">
        <div class="flex items-center justify-between mb-6">
          <h3 id="action-modal-title" class="text-xl font-bold text-white">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</h3>
          <button id="close-action-modal" class="text-gray-400 hover:text-white transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        
        <div id="action-modal-content">
          <!-- Action form will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Mock data for pending tournaments
      const pendingTournaments = [
        {
          id: 1,
          name: 'Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ø®Ù„ÙŠØ¬ Ø§Ù„ÙƒØ¨Ø±Ù‰',
          organizer: 'Ø£Ø­Ù…Ø¯ Ø§Ù„Ø®Ù„ÙŠØ¬ÙŠ',
          organizerEmail: 'ahmed@example.com',
          description: 'Ø¨Ø·ÙˆÙ„Ø© ÙƒØ¨Ø±Ù‰ ØªØ¬Ù…Ø¹ Ø£ÙØ¶Ù„ Ù„Ø§Ø¹Ø¨ÙŠ Ø§Ù„Ø®Ù„ÙŠØ¬ ÙÙŠ Ù…Ù†Ø§ÙØ³Ø© Ø´Ø±Ø³Ø©',
          format: 'single_elimination',
          gameFormat: '1v1',
          maxParticipants: 64,
          prizePool: 2000,
          currency: 'USD',
          startDate: '2024-03-20T18:00:00Z',
          endDate: '2024-03-25T22:00:00Z',
          status: 'pending',
          submittedAt: '2024-02-20T10:30:00Z',
          image: '/uploads/tournaments/gulf-championship.jpg',
          contactInfo: {
            discord: 'https://discord.gg/gulf-championship',
            telegram: 'https://t.me/gulf_championship',
            email: 'gulf@example.com'
          },
          rules: 'Ù‚ÙˆØ§Ù†ÙŠÙ† ØµØ§Ø±Ù…Ø© ÙˆØ¹Ø§Ø¯Ù„Ø© Ù„Ù„Ù…Ù†Ø§ÙØ³Ø©',
          maps: ['Desert Fury', 'Tournament Desert', 'Scorched Earth'],
          featured: false,
          priority: 'high'
        },
        {
          id: 2,
          name: 'ØªØ­Ø¯ÙŠ Ø§Ù„Ø´Ø¨Ø§Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ',
          organizer: 'Ù…Ø­Ù…Ø¯ Ø§Ù„Ø´Ø§Ø¨',
          organizerEmail: 'mohamed@example.com',
          description: 'Ø¨Ø·ÙˆÙ„Ø© Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø´Ø¨Ø§Ø¨ Ø§Ù„Ø¹Ø±Ø¨ÙŠ ØªØ­Øª 25 Ø³Ù†Ø©',
          format: 'double_elimination',
          gameFormat: '2v2',
          maxParticipants: 32,
          prizePool: 500,
          currency: 'USD',
          startDate: '2024-03-15T19:00:00Z',
          endDate: '2024-03-18T21:00:00Z',
          status: 'pending',
          submittedAt: '2024-02-18T14:20:00Z',
          image: '/uploads/tournaments/youth-challenge.jpg',
          contactInfo: {
            discord: 'https://discord.gg/youth-challenge',
            email: 'youth@example.com'
          },
          rules: 'Ù„Ù„Ø´Ø¨Ø§Ø¨ ØªØ­Øª 25 Ø³Ù†Ø© ÙÙ‚Ø·',
          maps: ['Green Pastures', 'Urban Combat'],
          featured: false,
          priority: 'medium'
        },
        {
          id: 3,
          name: 'Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ± Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
          organizer: 'Ø¹Ù…Ø± Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©',
          organizerEmail: 'legend@example.com',
          description: 'Ø¨Ø·ÙˆÙ„Ø© ØªØ¬Ù…Ø¹ Ø£Ø³Ø§Ø·ÙŠØ± Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙÙŠ Ù…Ø¹Ø±ÙƒØ© Ù…Ù„Ø­Ù…ÙŠØ©',
          format: 'round_robin',
          gameFormat: '1v1',
          maxParticipants: 16,
          prizePool: 1500,
          currency: 'USD',
          startDate: '2024-03-25T20:00:00Z',
          endDate: '2024-03-30T22:00:00Z',
          status: 'pending',
          submittedAt: '2024-02-19T09:15:00Z',
          image: '/uploads/tournaments/legends-championship.jpg',
          contactInfo: {
            discord: 'https://discord.gg/legends-championship',
            telegram: 'https://t.me/legends_championship',
            email: 'legends@example.com'
          },
          rules: 'Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø­ØªØ±ÙÙŠÙ† ÙÙ‚Ø· - Ù…Ø³ØªÙˆÙ‰ 70+',
          maps: ['Desert Fury', 'Winter Wolf', 'Tournament Desert', 'Scorched Earth'],
          featured: true,
          priority: 'high'
        }
      ];

      let currentTournaments = [...pendingTournaments];
      let selectedTournaments = new Set();
      let currentPage = 1;
      const itemsPerPage = 10;

      // Initialize
      loadTournaments();
      setupEventListeners();
      updateStats();

      function loadTournaments() {
        const searchTerm = document.getElementById('search-tournaments').value.toLowerCase();
        const statusFilter = document.getElementById('status-filter').value;

        // Filter tournaments
        let filteredTournaments = pendingTournaments.filter(tournament => {
          const matchesSearch = tournament.name.toLowerCase().includes(searchTerm) || 
                               tournament.organizer.toLowerCase().includes(searchTerm) ||
                               tournament.description.toLowerCase().includes(searchTerm);
          const matchesStatus = !statusFilter || tournament.status === statusFilter;
          
          return matchesSearch && matchesStatus;
        });

        // Sort by priority and date
        filteredTournaments.sort((a, b) => {
          const priorityOrder = { high: 3, medium: 2, low: 1 };
          if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
            return priorityOrder[b.priority] - priorityOrder[a.priority];
          }
          return new Date(b.submittedAt) - new Date(a.submittedAt);
        });

        displayTournaments(filteredTournaments);
      }

      function displayTournaments(tournaments) {
        const container = document.getElementById('tournaments-list');
        
        if (tournaments.length === 0) {
          container.innerHTML = `
            <div class="text-center py-20">
              <div class="text-6xl mb-4">ğŸ‰</div>
              <h3 class="text-xl font-semibold text-white mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø·ÙˆÙ„Ø§Øª ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h3>
              <p class="text-gray-400">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª ØªÙ… Ø§Ù„Ù†Ø¸Ø± ÙÙŠÙ‡Ø§</p>
            </div>
          `;
          return;
        }

        container.innerHTML = tournaments.map(tournament => `
          <div class="tournament-approval-card bg-card border border-border rounded-lg p-6 hover:shadow-lg transition-all duration-300 ${
            tournament.featured ? 'ring-2 ring-yellow-500/30' : ''
          }">
            <div class="flex items-start justify-between mb-4">
              <div class="flex items-center space-x-4 rtl:space-x-reverse">
                <label class="flex items-center cursor-pointer">
                  <input 
                    type="checkbox" 
                    class="tournament-checkbox w-5 h-5 text-orange-600 bg-gray-800 border-gray-600 rounded focus:ring-orange-500"
                    data-tournament-id="${tournament.id}"
                    ${selectedTournaments.has(tournament.id) ? 'checked' : ''}
                  />
                </label>
                <div class="flex-1">
                  <div class="flex items-center space-x-3 rtl:space-x-reverse mb-2">
                    <h3 class="text-xl font-bold text-white">${tournament.name}</h3>
                    ${tournament.featured ? `
                      <span class="px-2 py-1 bg-yellow-600 text-white text-xs rounded-full flex items-center space-x-1 rtl:space-x-reverse">
                        <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                        </svg>
                        <span>Ù…Ù…ÙŠØ²Ø©</span>
                      </span>
                    ` : ''}
                    <span class="px-2 py-1 text-xs rounded-full ${
                      tournament.priority === 'high' ? 'bg-red-600 text-white' :
                      tournament.priority === 'medium' ? 'bg-yellow-600 text-white' :
                      'bg-gray-600 text-white'
                    }">
                      ${tournament.priority === 'high' ? 'Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©' : 
                        tournament.priority === 'medium' ? 'Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©' : 'Ø£ÙˆÙ„ÙˆÙŠØ© Ù…Ù†Ø®ÙØ¶Ø©'}
                    </span>
                  </div>
                  
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                      <p class="text-gray-400 text-sm mb-1">Ø§Ù„Ù…Ù†Ø¸Ù…</p>
                      <p class="text-white">${tournament.organizer}</p>
                    </div>
                    <div>
                      <p class="text-gray-400 text-sm mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</p>
                      <p class="text-white">${formatDate(tournament.submittedAt)}</p>
                    </div>
                    <div>
                      <p class="text-gray-400 text-sm mb-1">Ø§Ù„Ù†ÙˆØ¹</p>
                      <p class="text-white">${formatType(tournament.format)} - ${tournament.gameFormat}</p>
                    </div>
                    <div>
                      <p class="text-gray-400 text-sm mb-1">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©</p>
                      <p class="text-white">${tournament.prizePool > 0 ? `$${tournament.prizePool}` : 'Ø¨Ø¯ÙˆÙ† Ø¬Ø§Ø¦Ø²Ø©'}</p>
                    </div>
                  </div>
                  
                  <p class="text-gray-300 text-sm mb-4 line-clamp-2">${tournament.description}</p>
                  
                  <div class="flex flex-wrap gap-2 mb-4">
                    ${tournament.maps.map(map => `
                      <span class="px-2 py-1 bg-gray-700 text-gray-300 text-xs rounded">${map}</span>
                    `).join('')}
                  </div>
                </div>
              </div>
              
              <div class="flex items-center space-x-2 rtl:space-x-reverse">
                <button 
                  onclick="viewTournament(${tournament.id})"
                  class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm"
                >
                  Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                </button>
                <div class="flex items-center space-x-1 rtl:space-x-reverse">
                  <button 
                    onclick="approveTournament(${tournament.id})"
                    class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm"
                  >
                    Ù…ÙˆØ§ÙÙ‚Ø©
                  </button>
                  <button 
                    onclick="rejectTournament(${tournament.id})"
                    class="px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm"
                  >
                    Ø±ÙØ¶
                  </button>
                  <button 
                    onclick="featureTournament(${tournament.id})"
                    class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors text-sm"
                  >
                    ${tournament.featured ? 'Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªÙ…ÙŠÙŠØ²' : 'ØªÙ…ÙŠÙŠØ²'}
                  </button>
                </div>
              </div>
            </div>
          </div>
        `).join('');

        // Update checkboxes
        updateCheckboxes();
      }

      function setupEventListeners() {
        // Search and filter
        document.getElementById('search-tournaments').addEventListener('input', loadTournaments);
        document.getElementById('status-filter').addEventListener('change', loadTournaments);

        // Bulk actions
        document.getElementById('bulk-approve').addEventListener('click', bulkApprove);
        document.getElementById('bulk-reject').addEventListener('click', bulkReject);
        document.getElementById('bulk-feature').addEventListener('click', bulkFeature);

        // Modal events
        document.getElementById('close-modal').addEventListener('click', closeModal);
        document.getElementById('close-action-modal').addEventListener('click', closeActionModal);

        // Tournament checkboxes
        document.addEventListener('change', function(e) {
          if (e.target.classList.contains('tournament-checkbox')) {
            const tournamentId = parseInt(e.target.dataset.tournamentId);
            if (e.target.checked) {
              selectedTournaments.add(tournamentId);
            } else {
              selectedTournaments.delete(tournamentId);
            }
            updateBulkActions();
          }
        });
      }

      function updateCheckboxes() {
        const checkboxes = document.querySelectorAll('.tournament-checkbox');
        checkboxes.forEach(checkbox => {
          const tournamentId = parseInt(checkbox.dataset.tournamentId);
          checkbox.checked = selectedTournaments.has(tournamentId);
        });
      }

      function updateBulkActions() {
        const hasSelected = selectedTournaments.size > 0;
        document.getElementById('bulk-approve').disabled = !hasSelected;
        document.getElementById('bulk-reject').disabled = !hasSelected;
        document.getElementById('bulk-feature').disabled = !hasSelected;
      }

      function updateStats() {
        const pending = pendingTournaments.filter(t => t.status === 'pending').length;
        const approved = pendingTournaments.filter(t => t.status === 'approved').length;
        const featured = pendingTournaments.filter(t => t.featured).length;

        document.getElementById('pending-count').textContent = pending;
        document.getElementById('approved-today').textContent = approved;
        document.getElementById('featured-count').textContent = featured;
      }

      function formatDate(dateString) {
        return new Date(dateString).toLocaleDateString('ar-SA', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
      }

      function formatType(type) {
        const types = {
          'single_elimination': 'Ø¥Ù‚ØµØ§Ø¡ Ù…Ø¨Ø§Ø´Ø±',
          'double_elimination': 'Ø¥Ù‚ØµØ§Ø¡ Ù…Ø²Ø¯ÙˆØ¬',
          'round_robin': 'Ø¯ÙˆØ±ÙŠ',
          'swiss': 'Ø³ÙˆÙŠØ³Ø±ÙŠ'
        };
        return types[type] || type;
      }

      function closeModal() {
        document.getElementById('tournament-modal').classList.add('hidden');
      }

      function closeActionModal() {
        document.getElementById('action-modal').classList.add('hidden');
      }

      // Global functions
      window.viewTournament = function(id) {
        const tournament = pendingTournaments.find(t => t.id === id);
        if (!tournament) return;

        const modal = document.getElementById('tournament-modal');
        const title = document.getElementById('modal-title');
        const content = document.getElementById('modal-content');

        title.textContent = tournament.name;
        content.innerHTML = `
          <div class="space-y-6">
            <!-- Tournament Image -->
            ${tournament.image ? `
              <div class="relative h-48 rounded-lg overflow-hidden">
                <img src="${tournament.image}" alt="${tournament.name}" class="w-full h-full object-cover">
              </div>
            ` : ''}
            
            <!-- Basic Info -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <h4 class="text-lg font-semibold text-white mb-3">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ©</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„Ù…Ù†Ø¸Ù…:</span>
                    <span class="text-white">${tournament.organizer}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</span>
                    <span class="text-white">${tournament.organizerEmail}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„Ù†ÙˆØ¹:</span>
                    <span class="text-white">${formatType(tournament.format)}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„ØµÙŠØºØ©:</span>
                    <span class="text-white">${tournament.gameFormat}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†:</span>
                    <span class="text-white">${tournament.maxParticipants}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©:</span>
                    <span class="text-white">${tournament.prizePool > 0 ? `$${tournament.prizePool}` : 'Ø¨Ø¯ÙˆÙ† Ø¬Ø§Ø¦Ø²Ø©'}</span>
                  </div>
                </div>
              </div>
              
              <div>
                <h4 class="text-lg font-semibold text-white mb-3">Ø§Ù„ØªÙˆÙ‚ÙŠØª</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</span>
                    <span class="text-white">${formatDate(tournament.startDate)}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-400">Ø§Ù„Ù†Ù‡Ø§ÙŠØ©:</span>
                    <span class="text-white">${formatDate(tournament.endDate)}</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-400">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…:</span>
                    <span class="text-white">${formatDate(tournament.submittedAt)}</span>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Description -->
            <div>
              <h4 class="text-lg font-semibold text-white mb-3">Ø§Ù„ÙˆØµÙ</h4>
              <p class="text-gray-300 leading-relaxed">${tournament.description}</p>
            </div>
            
            <!-- Rules -->
            <div>
              <h4 class="text-lg font-semibold text-white mb-3">Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†</h4>
              <div class="bg-gray-800 rounded-lg p-4">
                <pre class="text-gray-300 text-sm whitespace-pre-wrap">${tournament.rules}</pre>
              </div>
            </div>
            
            <!-- Maps -->
            <div>
              <h4 class="text-lg font-semibold text-white mb-3">Ø§Ù„Ø®Ø±Ø§Ø¦Ø·</h4>
              <div class="flex flex-wrap gap-2">
                ${tournament.maps.map(map => `
                  <span class="px-3 py-1 bg-gray-700 text-gray-300 text-sm rounded-full">${map}</span>
                `).join('')}
              </div>
            </div>
            
            <!-- Contact Info -->
            <div>
              <h4 class="text-lg font-semibold text-white mb-3">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„</h4>
              <div class="space-y-2">
                ${tournament.contactInfo.discord ? `
                  <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <span class="text-gray-400">Discord:</span>
                    <a href="${tournament.contactInfo.discord}" target="_blank" class="text-blue-400 hover:text-blue-300">${tournament.contactInfo.discord}</a>
                  </div>
                ` : ''}
                ${tournament.contactInfo.telegram ? `
                  <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <span class="text-gray-400">Telegram:</span>
                    <a href="${tournament.contactInfo.telegram}" target="_blank" class="text-blue-400 hover:text-blue-300">${tournament.contactInfo.telegram}</a>
                  </div>
                ` : ''}
                ${tournament.contactInfo.email ? `
                  <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <span class="text-gray-400">Email:</span>
                    <a href="mailto:${tournament.contactInfo.email}" class="text-blue-400 hover:text-blue-300">${tournament.contactInfo.email}</a>
                  </div>
                ` : ''}
              </div>
            </div>
            
            <!-- Actions -->
            <div class="flex items-center justify-end space-x-4 rtl:space-x-reverse pt-6 border-t border-gray-700">
              <button onclick="approveTournament(${tournament.id})" class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                Ù…ÙˆØ§ÙÙ‚Ø©
              </button>
              <button onclick="rejectTournament(${tournament.id})" class="px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                Ø±ÙØ¶
              </button>
              <button onclick="featureTournament(${tournament.id})" class="px-6 py-3 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors">
                ${tournament.featured ? 'Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªÙ…ÙŠÙŠØ²' : 'ØªÙ…ÙŠÙŠØ²'}
              </button>
            </div>
          </div>
        `;

        modal.classList.remove('hidden');
      };

      window.approveTournament = function(id) {
        const tournament = pendingTournaments.find(t => t.id === id);
        if (!tournament) return;

        const modal = document.getElementById('action-modal');
        const title = document.getElementById('action-modal-title');
        const content = document.getElementById('action-modal-content');

        title.textContent = 'Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©';
        content.innerHTML = `
          <div class="space-y-4">
            <p class="text-gray-300">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø¨Ø·ÙˆÙ„Ø© "${tournament.name}"ØŸ</p>
            
            <div class="space-y-3">
              <label class="flex items-center space-x-2 rtl:space-x-reverse">
                <input type="checkbox" id="send-notification" class="w-4 h-4 text-green-600 bg-gray-800 border-gray-600 rounded focus:ring-green-500" checked>
                <span class="text-gray-300">Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¹Ø§Ù… Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
              </label>
              
              <label class="flex items-center space-x-2 rtl:space-x-reverse">
                <input type="checkbox" id="make-featured" class="w-4 h-4 text-yellow-600 bg-gray-800 border-gray-600 rounded focus:ring-yellow-500">
                <span class="text-gray-300">Ø¬Ø¹Ù„ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ù…Ù…ÙŠØ²Ø©</span>
              </label>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Ø±Ø³Ø§Ù„Ø© Ø¥Ø¶Ø§ÙÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
              <textarea 
                id="approval-message" 
                rows="3" 
                class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500"
                placeholder="Ø±Ø³Ø§Ù„Ø© ØªÙ‡Ù†Ø¦Ø© Ø£Ùˆ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©..."
              ></textarea>
            </div>
            
            <div class="flex items-center justify-end space-x-3 rtl:space-x-reverse pt-4">
              <button onclick="closeActionModal()" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors">
                Ø¥Ù„ØºØ§Ø¡
              </button>
              <button onclick="confirmApproval(${id})" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                Ù…ÙˆØ§ÙÙ‚Ø©
              </button>
            </div>
          </div>
        `;

        modal.classList.remove('hidden');
      };

      window.rejectTournament = function(id) {
        const tournament = pendingTournaments.find(t => t.id === id);
        if (!tournament) return;

        const modal = document.getElementById('action-modal');
        const title = document.getElementById('action-modal-title');
        const content = document.getElementById('action-modal-content');

        title.textContent = 'Ø±ÙØ¶ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©';
        content.innerHTML = `
          <div class="space-y-4">
            <p class="text-gray-300">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¶ Ø¨Ø·ÙˆÙ„Ø© "${tournament.name}"ØŸ</p>
            
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶ *</label>
              <select id="rejection-reason" class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500" required>
                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³Ø¨Ø¨</option>
                <option value="incomplete_info">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©</option>
                <option value="inappropriate_content">Ù…Ø­ØªÙˆÙ‰ ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨</option>
                <option value="duplicate">Ø¨Ø·ÙˆÙ„Ø© Ù…ÙƒØ±Ø±Ø©</option>
                <option value="unrealistic_dates">ØªÙˆØ§Ø±ÙŠØ® ØºÙŠØ± ÙˆØ§Ù‚Ø¹ÙŠØ©</option>
                <option value="other">Ø£Ø®Ø±Ù‰</option>
              </select>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-300 mb-2">ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©</label>
              <textarea 
                id="rejection-details" 
                rows="3" 
                class="w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-red-500"
                placeholder="Ø§Ø´Ø±Ø­ Ø§Ù„Ø³Ø¨Ø¨ Ø¨Ø§Ù„ØªÙØµÙŠÙ„..."
              ></textarea>
            </div>
            
            <div class="flex items-center justify-end space-x-3 rtl:space-x-reverse pt-4">
              <button onclick="closeActionModal()" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors">
                Ø¥Ù„ØºØ§Ø¡
              </button>
              <button onclick="confirmRejection(${id})" class="px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors">
                Ø±ÙØ¶
              </button>
            </div>
          </div>
        `;

        modal.classList.remove('hidden');
      };

      window.featureTournament = function(id) {
        const tournament = pendingTournaments.find(t => t.id === id);
        if (!tournament) return;

        tournament.featured = !tournament.featured;
        const action = tournament.featured ? 'ØªÙ… ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©' : 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©';
        
        showToast(action, 'success');
        loadTournaments();
        updateStats();
      };

      window.confirmApproval = function(id) {
        const tournament = pendingTournaments.find(t => t.id === id);
        if (!tournament) return;

        const sendNotification = document.getElementById('send-notification').checked;
        const makeFeatured = document.getElementById('make-featured').checked;
        const message = document.getElementById('approval-message').value;

        tournament.status = 'approved';
        if (makeFeatured) tournament.featured = true;

        showToast('ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
        
        if (sendNotification) {
          showToast('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¹Ø§Ù… Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†', 'info');
        }

        closeActionModal();
        closeModal();
        loadTournaments();
        updateStats();
      };

      window.confirmRejection = function(id) {
        const tournament = pendingTournaments.find(t => t.id === id);
        if (!tournament) return;

        const reason = document.getElementById('rejection-reason').value;
        const details = document.getElementById('rejection-details').value;

        if (!reason) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø³Ø¨Ø¨ Ø§Ù„Ø±ÙØ¶', 'error');
          return;
        }

        tournament.status = 'rejected';
        tournament.rejectionReason = reason;
        tournament.rejectionDetails = details;

        showToast('ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©', 'success');
        
        closeActionModal();
        closeModal();
        loadTournaments();
        updateStats();
      };

      function bulkApprove() {
        if (selectedTournaments.size === 0) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø·ÙˆÙ„Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
          return;
        }

        if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ ${selectedTournaments.size} Ø¨Ø·ÙˆÙ„Ø©ØŸ`)) {
          selectedTournaments.forEach(id => {
            const tournament = pendingTournaments.find(t => t.id === id);
            if (tournament) {
              tournament.status = 'approved';
            }
          });

          showToast(`ØªÙ… Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ ${selectedTournaments.size} Ø¨Ø·ÙˆÙ„Ø©`, 'success');
          selectedTournaments.clear();
          loadTournaments();
          updateStats();
        }
      }

      function bulkReject() {
        if (selectedTournaments.size === 0) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø·ÙˆÙ„Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
          return;
        }

        if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ÙØ¶ ${selectedTournaments.size} Ø¨Ø·ÙˆÙ„Ø©ØŸ`)) {
          selectedTournaments.forEach(id => {
            const tournament = pendingTournaments.find(t => t.id === id);
            if (tournament) {
              tournament.status = 'rejected';
            }
          });

          showToast(`ØªÙ… Ø±ÙØ¶ ${selectedTournaments.size} Ø¨Ø·ÙˆÙ„Ø©`, 'success');
          selectedTournaments.clear();
          loadTournaments();
          updateStats();
        }
      }

      function bulkFeature() {
        if (selectedTournaments.size === 0) {
          showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¨Ø·ÙˆÙ„Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'error');
          return;
        }

        if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ…ÙŠÙŠØ² ${selectedTournaments.size} Ø¨Ø·ÙˆÙ„Ø©ØŸ`)) {
          selectedTournaments.forEach(id => {
            const tournament = pendingTournaments.find(t => t.id === id);
            if (tournament) {
              tournament.featured = true;
            }
          });

          showToast(`ØªÙ… ØªÙ…ÙŠÙŠØ² ${selectedTournaments.size} Ø¨Ø·ÙˆÙ„Ø©`, 'success');
          selectedTournaments.clear();
          loadTournaments();
          updateStats();
        }
      }

      function showToast(message, type = 'info') {
        const toast = document.createElement('div');
        toast.className = `fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white font-medium ${
          type === 'success' ? 'bg-green-600' : 
          type === 'error' ? 'bg-red-600' : 
          'bg-blue-600'
        }`;
        toast.textContent = message;
        
        document.body.appendChild(toast);
        
        setTimeout(() => {
          toast.remove();
        }, 3000);
      }
    });
  </script>
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .tournament-approval-card {
    transition: all 0.3s ease;
  }

  .tournament-approval-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
  }
</style> 