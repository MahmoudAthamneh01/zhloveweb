---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import { 
  BarChart3, 
  TrendingUp, 
  TrendingDown, 
  Users, 
  Shield, 
  Play, 
  Star,
  Trophy,
  Calendar,
  Clock,
  Eye,
  Download,
  RefreshCw,
  Filter,
  Target,
  Activity,
  Globe,
  Map,
  Gamepad2,
  Crown,
  Medal,
  Zap
} from 'lucide-react';

const title = "Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©";
const description = "ØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø© Ø¹Ù† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ù†ØµØ© ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†";

// Mock analytics data
const overallStats = {
  users: {
    total: 25847,
    active: 18945,
    newThisMonth: 1247,
    growth: 12.5,
    dailyActive: 8456,
    weeklyActive: 15678,
    monthlyActive: 21234
  },
  content: {
    clans: 156,
    replays: 8945,
    streamers: 78,
    tournaments: 23,
    forumPosts: 12456
  },
  activity: {
    totalGames: 456789,
    gamesThisMonth: 34567,
    averageSessionTime: 45,
    totalPlayTime: 234567,
    peakConcurrent: 1234
  },
  revenue: {
    totalRevenue: 125000,
    monthlyRevenue: 15000,
    subscriptions: 2456,
    donations: 5678
  }
};

const userGrowth = [
  { month: 'ÙŠÙ†Ø§ÙŠØ±', users: 22345, growth: 8.2 },
  { month: 'ÙØ¨Ø±Ø§ÙŠØ±', users: 23456, growth: 5.0 },
  { month: 'Ù…Ø§Ø±Ø³', users: 24123, growth: 2.8 },
  { month: 'Ø£Ø¨Ø±ÙŠÙ„', users: 24789, growth: 2.8 },
  { month: 'Ù…Ø§ÙŠÙˆ', users: 25234, growth: 1.8 },
  { month: 'ÙŠÙˆÙ†ÙŠÙˆ', users: 25847, growth: 2.4 }
];

const gameStats = {
  totalMatches: 456789,
  averageMatchDuration: 25,
  popularMaps: [
    { name: 'Tournament Desert', matches: 45678, percentage: 28.5 },
    { name: 'Scorched Earth', matches: 34567, percentage: 21.6 },
    { name: 'Winter Wolf', matches: 28956, percentage: 18.1 },
    { name: 'Final Crusade', matches: 23456, percentage: 14.7 },
    { name: 'Defcon 6', matches: 18945, percentage: 11.8 }
  ],
  factionUsage: [
    { faction: 'USA', usage: 38.5, wins: 45.2 },
    { faction: 'China', usage: 32.8, wins: 41.8 },
    { faction: 'GLA', usage: 28.7, wins: 38.9 }
  ],
  peakHours: [
    { hour: '20:00', players: 1234 },
    { hour: '21:00', players: 1456 },
    { hour: '22:00', players: 1289 },
    { hour: '19:00', players: 1123 },
    { hour: '23:00', players: 1089 }
  ]
};

const regionalStats = [
  { country: 'Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©', users: 8456, percentage: 32.7 },
  { country: 'Ù…ØµØ±', users: 5678, percentage: 22.0 },
  { country: 'Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª', users: 3456, percentage: 13.4 },
  { country: 'Ø§Ù„ÙƒÙˆÙŠØª', users: 2345, percentage: 9.1 },
  { country: 'Ù‚Ø·Ø±', users: 1789, percentage: 6.9 },
  { country: 'Ø£Ø®Ø±Ù‰', users: 4123, percentage: 15.9 }
];

const contentStats = {
  replays: {
    total: 8945,
    approved: 8822,
    pending: 23,
    rejected: 100,
    avgViews: 456,
    topReplays: [
      { title: 'Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø£Ø³Ø§Ø·ÙŠØ±', views: 12456, rating: 4.8 },
      { title: 'ØªÙƒØªÙŠÙƒØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©', views: 9876, rating: 4.6 },
      { title: 'Ø§Ù„Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø®Ø§Ø·Ù', views: 8765, rating: 4.7 }
    ]
  },
  streamers: {
    total: 78,
    verified: 45,
    totalFollowers: 456789,
    totalViews: 12456789,
    avgEngagement: 8.5
  },
  clans: {
    total: 156,
    active: 134,
    totalMembers: 5678,
    avgMembersPerClan: 36,
    topClans: [
      { name: 'Ù†Ø³ÙˆØ± Ø§Ù„Ø´Ø±Ù‚', members: 150, rating: 2456 },
      { name: 'Ù…Ø­Ø§Ø±Ø¨Ùˆ Ø§Ù„ØµØ­Ø±Ø§Ø¡', members: 145, rating: 2398 },
      { name: 'Ø£Ø³Ø§Ø·ÙŠØ± Ø§Ù„Ø®Ù„ÙŠØ¬', members: 132, rating: 2287 }
    ]
  }
};

// Check if user is admin
const isAdmin = true;
if (!isAdmin) {
  return new Response('Unauthorized', { status: 401 });
}
---

<BaseLayout title={title} description={description}>
  <div class="container-custom py-8">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
      <div>
        <h1 class="text-3xl font-bold text-foreground mb-2 flex items-center space-x-3 rtl:space-x-reverse">
          <BarChart3 size={32} class="text-tactical-green" />
          <span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
        </h1>
        <p class="text-muted-foreground">ØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø© Ø¹Ù† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ù†ØµØ© ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
      </div>
      <div class="flex items-center space-x-2 rtl:space-x-reverse">
        <select class="bg-input border border-border rounded px-3 py-2 text-sm">
          <option value="7d">Ø¢Ø®Ø± 7 Ø£ÙŠØ§Ù…</option>
          <option value="30d">Ø¢Ø®Ø± 30 ÙŠÙˆÙ…</option>
          <option value="90d">Ø¢Ø®Ø± 3 Ø£Ø´Ù‡Ø±</option>
          <option value="1y">Ø¢Ø®Ø± Ø¹Ø§Ù…</option>
        </select>
        <button class="btn btn-outline">
          <Download size={16} />
          <span>ØªØµØ¯ÙŠØ±</span>
        </button>
        <button class="btn btn-outline">
          <RefreshCw size={16} />
          <span>ØªØ­Ø¯ÙŠØ«</span>
        </button>
      </div>
    </div>

    <!-- Overall Stats -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
      <div class="military-card p-4">
        <div class="flex items-center justify-between mb-2">
          <Users size={24} class="text-tactical-green" />
          <div class="flex items-center space-x-1 rtl:space-x-reverse text-sm text-tactical-green">
            <TrendingUp size={16} />
            <span>+{overallStats.users.growth}%</span>
          </div>
        </div>
        <div class="text-2xl font-bold text-foreground">{overallStats.users.total.toLocaleString()}</div>
        <div class="text-sm text-muted-foreground">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
        <div class="text-xs text-tactical-green mt-1">+{overallStats.users.newThisMonth} Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</div>
      </div>

      <div class="military-card p-4">
        <div class="flex items-center justify-between mb-2">
          <Activity size={24} class="text-command-blue" />
          <div class="flex items-center space-x-1 rtl:space-x-reverse text-sm text-command-blue">
            <Eye size={16} />
            <span>{overallStats.users.dailyActive.toLocaleString()}</span>
          </div>
        </div>
        <div class="text-2xl font-bold text-foreground">{overallStats.users.active.toLocaleString()}</div>
        <div class="text-sm text-muted-foreground">Ù…Ø³ØªØ®Ø¯Ù… Ù†Ø´Ø·</div>
        <div class="text-xs text-command-blue mt-1">ÙŠÙˆÙ…ÙŠ: {overallStats.users.dailyActive.toLocaleString()}</div>
      </div>

      <div class="military-card p-4">
        <div class="flex items-center justify-between mb-2">
          <Gamepad2 size={24} class="text-victory-gold" />
          <div class="flex items-center space-x-1 rtl:space-x-reverse text-sm text-victory-gold">
            <Target size={16} />
            <span>{overallStats.activity.peakConcurrent}</span>
          </div>
        </div>
        <div class="text-2xl font-bold text-foreground">{overallStats.activity.totalGames.toLocaleString()}</div>
        <div class="text-sm text-muted-foreground">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª</div>
        <div class="text-xs text-victory-gold mt-1">Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±: {overallStats.activity.gamesThisMonth.toLocaleString()}</div>
      </div>

      <div class="military-card p-4">
        <div class="flex items-center justify-between mb-2">
          <Clock size={24} class="text-orange-500" />
          <div class="flex items-center space-x-1 rtl:space-x-reverse text-sm text-orange-500">
            <Zap size={16} />
            <span>{overallStats.activity.averageSessionTime}Ø¯Ù‚ÙŠÙ‚Ø©</span>
          </div>
        </div>
        <div class="text-2xl font-bold text-foreground">{overallStats.activity.totalPlayTime.toLocaleString()}</div>
        <div class="text-sm text-muted-foreground">Ø³Ø§Ø¹Ø© Ù„Ø¹Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©</div>
        <div class="text-xs text-orange-500 mt-1">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¬Ù„Ø³Ø©: {overallStats.activity.averageSessionTime}Ø¯Ù‚ÙŠÙ‚Ø©</div>
      </div>
    </div>

    <!-- User Growth Chart -->
    <div class="military-card p-6 mb-8">
      <h2 class="text-xl font-bold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
        <TrendingUp size={20} class="text-tactical-green" />
        <span>Ù†Ù…Ùˆ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
      </h2>
      <div class="space-y-4">
        {userGrowth.map((data, index) => (
          <div key={index} class="flex items-center justify-between p-3 bg-muted rounded-lg">
            <div class="flex items-center space-x-3 rtl:space-x-reverse">
              <div class="w-12 h-12 bg-tactical-green/20 rounded-full flex items-center justify-center">
                <span class="text-tactical-green font-bold">{index + 1}</span>
              </div>
              <div>
                <div class="font-medium text-foreground">{data.month}</div>
                <div class="text-sm text-muted-foreground">{data.users.toLocaleString()} Ù…Ø³ØªØ®Ø¯Ù…</div>
              </div>
            </div>
            <div class="flex items-center space-x-2 rtl:space-x-reverse">
              <div class="w-32 bg-muted rounded-full h-2">
                <div 
                  class="bg-tactical-green h-2 rounded-full"
                  style={`width: ${Math.min(data.growth * 10, 100)}%`}
                ></div>
              </div>
              <span class="text-sm font-medium text-tactical-green">+{data.growth}%</span>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Regional Distribution -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      <div class="military-card p-6">
        <h2 class="text-xl font-bold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
          <Globe size={20} class="text-command-blue" />
          <span>Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</span>
        </h2>
        <div class="space-y-3">
          {regionalStats.map((region, index) => (
            <div key={index} class="flex items-center justify-between">
              <div class="flex items-center space-x-2 rtl:space-x-reverse">
                <div class="w-6 h-6 bg-command-blue/20 rounded-full flex items-center justify-center">
                  <span class="text-xs font-bold text-command-blue">{index + 1}</span>
                </div>
                <span class="font-medium text-foreground">{region.country}</span>
              </div>
              <div class="flex items-center space-x-2 rtl:space-x-reverse">
                <div class="w-24 bg-muted rounded-full h-2">
                  <div 
                    class="bg-command-blue h-2 rounded-full"
                    style={`width: ${region.percentage}%`}
                  ></div>
                </div>
                <span class="text-sm text-muted-foreground w-12">{region.percentage}%</span>
                <span class="text-sm font-medium text-foreground w-16">{region.users.toLocaleString()}</span>
              </div>
            </div>
          ))}
        </div>
      </div>

      <div class="military-card p-6">
        <h2 class="text-xl font-bold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
          <Target size={20} class="text-victory-gold" />
          <span>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙØµØ§Ø¦Ù„</span>
        </h2>
        <div class="space-y-4">
          {gameStats.factionUsage.map((faction, index) => (
            <div key={index} class="p-3 bg-muted rounded-lg">
              <div class="flex items-center justify-between mb-2">
                <div class="flex items-center space-x-2 rtl:space-x-reverse">
                  <span class="text-2xl">
                    {faction.faction === 'USA' ? 'ğŸ‡ºğŸ‡¸' : faction.faction === 'China' ? 'ğŸ‡¨ğŸ‡³' : 'â˜ªï¸'}
                  </span>
                  <span class="font-medium text-foreground">{faction.faction}</span>
                </div>
                <span class="text-sm text-muted-foreground">{faction.usage}%</span>
              </div>
              <div class="space-y-1">
                <div class="w-full bg-muted-foreground/20 rounded-full h-2">
                  <div 
                    class="bg-victory-gold h-2 rounded-full"
                    style={`width: ${faction.usage}%`}
                  ></div>
                </div>
                <div class="text-xs text-muted-foreground">Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙÙˆØ²: {faction.wins}%</div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>

    <!-- Content Statistics -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <div class="military-card p-6">
        <h3 class="text-lg font-semibold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
          <Play size={20} class="text-tactical-green" />
          <span>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±ÙŠØ¨Ù„Ø§ÙŠØ²</span>
        </h3>
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
            <span class="font-medium text-foreground">{contentStats.replays.total.toLocaleString()}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø§Ù„Ù…Ø¹ØªÙ…Ø¯:</span>
            <span class="font-medium text-tactical-green">{contentStats.replays.approved.toLocaleString()}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±:</span>
            <span class="font-medium text-orange-500">{contentStats.replays.pending}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª:</span>
            <span class="font-medium text-foreground">{contentStats.replays.avgViews}</span>
          </div>
        </div>
      </div>

      <div class="military-card p-6">
        <h3 class="text-lg font-semibold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
          <Star size={20} class="text-orange-500" />
          <span>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³ØªØ±ÙŠÙ…Ø±Ø²</span>
        </h3>
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
            <span class="font-medium text-foreground">{contentStats.streamers.total}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø§Ù„Ù…ÙˆØ«Ù‚:</span>
            <span class="font-medium text-tactical-green">{contentStats.streamers.verified}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªØ§Ø¨Ø¹ÙŠÙ†:</span>
            <span class="font-medium text-foreground">{contentStats.streamers.totalFollowers.toLocaleString()}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙØ§Ø¹Ù„:</span>
            <span class="font-medium text-foreground">{contentStats.streamers.avgEngagement}%</span>
          </div>
        </div>
      </div>

      <div class="military-card p-6">
        <h3 class="text-lg font-semibold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
          <Shield size={20} class="text-command-blue" />
          <span>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø´Ø§Ø¦Ø±</span>
        </h3>
        <div class="space-y-3">
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
            <span class="font-medium text-foreground">{contentStats.clans.total}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø§Ù„Ù†Ø´Ø·:</span>
            <span class="font-medium text-tactical-green">{contentStats.clans.active}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡:</span>
            <span class="font-medium text-foreground">{contentStats.clans.totalMembers.toLocaleString()}</span>
          </div>
          <div class="flex justify-between">
            <span class="text-muted-foreground">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡:</span>
            <span class="font-medium text-foreground">{contentStats.clans.avgMembersPerClan}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Popular Maps -->
    <div class="military-card p-6 mb-8">
      <h2 class="text-xl font-bold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
        <Map size={20} class="text-victory-gold" />
        <span>Ø§Ù„Ø®Ø±Ø§Ø¦Ø· Ø§Ù„Ø£ÙƒØ«Ø± Ø´Ø¹Ø¨ÙŠØ©</span>
      </h2>
      <div class="space-y-3">
        {gameStats.popularMaps.map((map, index) => (
          <div key={index} class="flex items-center justify-between p-3 bg-muted rounded-lg">
            <div class="flex items-center space-x-3 rtl:space-x-reverse">
              <div class="w-8 h-8 bg-victory-gold/20 rounded-full flex items-center justify-center">
                <span class="text-victory-gold font-bold text-sm">{index + 1}</span>
              </div>
              <div>
                <div class="font-medium text-foreground">{map.name}</div>
                <div class="text-sm text-muted-foreground">{map.matches.toLocaleString()} Ù…Ø¨Ø§Ø±Ø§Ø©</div>
              </div>
            </div>
            <div class="flex items-center space-x-2 rtl:space-x-reverse">
              <div class="w-32 bg-muted rounded-full h-2">
                <div 
                  class="bg-victory-gold h-2 rounded-full"
                  style={`width: ${map.percentage}%`}
                ></div>
              </div>
              <span class="text-sm font-medium text-foreground">{map.percentage}%</span>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Peak Hours -->
    <div class="military-card p-6">
      <h2 class="text-xl font-bold text-foreground mb-4 flex items-center space-x-2 rtl:space-x-reverse">
        <Clock size={20} class="text-orange-500" />
        <span>Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø°Ø±ÙˆØ©</span>
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
        {gameStats.peakHours.map((peak, index) => (
          <div key={index} class="text-center p-3 bg-muted rounded-lg">
            <div class="text-lg font-bold text-foreground">{peak.hour}</div>
            <div class="text-sm text-muted-foreground">{peak.players} Ù„Ø§Ø¹Ø¨</div>
            <div class="w-full bg-muted-foreground/20 rounded-full h-1 mt-2">
              <div 
                class="bg-orange-500 h-1 rounded-full"
                style={`width: ${(peak.players / 1456) * 100}%`}
              ></div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</BaseLayout> 