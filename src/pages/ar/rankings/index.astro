---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import LeaderBoard from '../../../components/rankings/LeaderBoard.tsx';
import { Trophy, Users, Globe, Calendar, Star, Target, Medal, Crown, Shield } from 'lucide-react';

const title = "التصنيفات - زد اتش لوف";
const description = "تصفح تصنيفات أفضل لاعبي الجنرالات زيرو آور محلياً وعالمياً";

// Mock rankings data
const globalRankings = [
  {
    position: 1,
    previousPosition: 2,
    change: 1,
    player: {
      id: 1,
      username: 'sultan_war',
      displayName: 'سلطان الحرب',
      avatar: '/avatars/sultan_war.png',
      country: 'السعودية',
      verified: true,
      isOnline: true,
      clan: {
        id: 1,
        name: 'نسور الشرق',
        tag: 'EAST',
        verified: true
      }
    },
    stats: {
      rating: 2847,
      ratingChange: 25,
      totalGames: 1250,
      wins: 1125,
      losses: 125,
      winRate: 90,
      streak: 12,
      points: 285000,
      level: 87
    },
    tier: 'Legend',
    recentActivity: {
      lastPlayed: '2024-01-15T20:30:00Z',
      gamesThisWeek: 15,
      activityLevel: 'high'
    },
    achievements: {
      total: 45,
      recent: [
        { name: 'أسطورة الشرق', icon: '👑', rarity: 'legendary' },
        { name: 'محطم الأرقام', icon: '🏆', rarity: 'epic' }
      ]
    },
    specialTags: [
      { type: 'champion', label: 'بطل الموسم', color: 'gold' }
    ]
  },
  {
    position: 2,
    previousPosition: 1,
    change: -1,
    player: {
      id: 2,
      username: 'desert_king',
      displayName: 'ملك الصحراء',
      avatar: '/avatars/desert_king.png',
      country: 'مصر',
      verified: true,
      isOnline: false,
      clan: {
        id: 2,
        name: 'محاربو الصحراء',
        tag: 'DSRT',
        verified: true
      }
    },
    stats: {
      rating: 2823,
      ratingChange: -15,
      totalGames: 1180,
      wins: 1062,
      losses: 118,
      winRate: 90,
      streak: 8,
      points: 275000,
      level: 84
    },
    tier: 'Legend',
    recentActivity: {
      lastPlayed: '2024-01-14T19:45:00Z',
      gamesThisWeek: 12,
      activityLevel: 'high'
    },
    achievements: {
      total: 42,
      recent: [
        { name: 'سيد GLA', icon: '☪️', rarity: 'epic' }
      ]
    },
    specialTags: [
      { type: 'veteran', label: 'محارب قديم', color: 'blue' }
    ]
  },
  {
    position: 3,
    previousPosition: 3,
    change: 0,
    player: {
      id: 3,
      username: 'gulf_commander',
      displayName: 'قائد الخليج',
      avatar: '/avatars/gulf_commander.png',
      country: 'الإمارات',
      verified: true,
      isOnline: true,
      clan: {
        id: 3,
        name: 'أساطير الخليج',
        tag: 'GULF',
        verified: true
      }
    },
    stats: {
      rating: 2756,
      ratingChange: 8,
      totalGames: 1050,
      wins: 935,
      losses: 115,
      winRate: 89,
      streak: 5,
      points: 260000,
      level: 78
    },
    tier: 'Grandmaster',
    recentActivity: {
      lastPlayed: '2024-01-15T21:00:00Z',
      gamesThisWeek: 18,
      activityLevel: 'high'
    },
    achievements: {
      total: 38,
      recent: [
        { name: 'خبير USA', icon: '🇺🇸', rarity: 'rare' }
      ]
    },
    specialTags: [
      { type: 'rising_star', label: 'نجم صاعد', color: 'green' }
    ]
  }
];

// Add more players (4-50)
for (let i = 4; i <= 50; i++) {
  globalRankings.push({
    position: i,
    previousPosition: i + Math.floor(Math.random() * 6 - 3),
    change: Math.floor(Math.random() * 6 - 3),
    player: {
      id: i,
      username: `player_${i}`,
      displayName: `لاعب ${i}`,
      avatar: `/avatars/player_${i}.png`,
      country: ['السعودية', 'مصر', 'الإمارات', 'الكويت', 'قطر', 'البحرين', 'عمان'][Math.floor(Math.random() * 7)],
      verified: Math.random() > 0.7,
      isOnline: Math.random() > 0.6,
      clan: Math.random() > 0.5 ? {
        id: Math.floor(Math.random() * 10) + 1,
        name: `عشيرة ${i}`,
        tag: `T${i}`,
        verified: Math.random() > 0.8
      } : undefined
    },
    stats: {
      rating: Math.floor(2700 - (i * 20) + Math.random() * 40),
      ratingChange: Math.floor(Math.random() * 60 - 30),
      totalGames: Math.floor(800 + Math.random() * 400),
      wins: Math.floor(600 + Math.random() * 300),
      losses: Math.floor(100 + Math.random() * 200),
      winRate: Math.floor(60 + Math.random() * 30),
      streak: Math.floor(Math.random() * 20 - 10),
      points: Math.floor(180000 + Math.random() * 80000),
      level: Math.floor(40 + Math.random() * 40)
    },
    tier: ['Legend', 'Grandmaster', 'Master', 'Diamond', 'Platinum', 'Gold'][Math.floor(Math.random() * 6)],
    recentActivity: {
      lastPlayed: new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000).toISOString(),
      gamesThisWeek: Math.floor(Math.random() * 25),
      activityLevel: ['high', 'medium', 'low'][Math.floor(Math.random() * 3)]
    },
    achievements: {
      total: Math.floor(Math.random() * 50),
      recent: []
    },
    specialTags: []
  });
}

const rankingStats = {
  totalPlayers: 15847,
  activePlayers: 8945,
  legendPlayers: 25,
  grandmasterPlayers: 180,
  averageRating: 1580
};

const leaderboardFilters = {
  regions: ['السعودية', 'مصر', 'الإمارات', 'الكويت', 'قطر', 'البحرين', 'عمان'],
  tiers: ['Legend', 'Grandmaster', 'Master', 'Diamond', 'Platinum', 'Gold', 'Silver', 'Bronze'],
  timePeriods: ['هذا الأسبوع', 'هذا الشهر', 'الموسم الحالي', 'كل الأوقات']
};
---

<BaseLayout title={title} description={description}>
  <div class="container-custom py-8">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-foreground mb-2 flex items-center justify-center space-x-3 rtl:space-x-reverse">
        <Trophy size={32} class="text-victory-gold" />
        <span>التصنيفات</span>
      </h1>
      <p class="text-muted-foreground max-w-2xl mx-auto">
        تصفح تصنيفات أفضل لاعبي الجنرالات زيرو آور وتنافس للوصول إلى القمة
      </p>
    </div>

    <!-- Statistics -->
    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-tactical-green mb-1">{rankingStats.totalPlayers.toLocaleString()}</div>
        <div class="text-sm text-muted-foreground">إجمالي اللاعبين</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-command-blue mb-1">{rankingStats.activePlayers.toLocaleString()}</div>
        <div class="text-sm text-muted-foreground">نشط</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-victory-gold mb-1">{rankingStats.legendPlayers}</div>
        <div class="text-sm text-muted-foreground">أسطورة</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-purple-500 mb-1">{rankingStats.grandmasterPlayers}</div>
        <div class="text-sm text-muted-foreground">جراند ماستر</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-neutral-silver mb-1">{rankingStats.averageRating}</div>
        <div class="text-sm text-muted-foreground">متوسط التقييم</div>
      </div>
    </div>

    <!-- Ranking Categories -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
      <a href="/ar/rankings/global" class="military-card p-4 hover:shadow-lg transition-shadow">
        <div class="flex items-center space-x-3 rtl:space-x-reverse">
          <Globe size={32} class="text-tactical-green" />
          <div>
            <h3 class="font-bold text-foreground">التصنيف العالمي</h3>
            <p class="text-sm text-muted-foreground">أفضل اللاعبين حول العالم</p>
          </div>
        </div>
      </a>
      
      <a href="/ar/rankings/regional" class="military-card p-4 hover:shadow-lg transition-shadow">
        <div class="flex items-center space-x-3 rtl:space-x-reverse">
          <Target size={32} class="text-command-blue" />
          <div>
            <h3 class="font-bold text-foreground">التصنيف الإقليمي</h3>
            <p class="text-sm text-muted-foreground">أفضل اللاعبين في منطقتك</p>
          </div>
        </div>
      </a>
      
      <a href="/ar/rankings/clans" class="military-card p-4 hover:shadow-lg transition-shadow">
        <div class="flex items-center space-x-3 rtl:space-x-reverse">
          <Shield size={32} class="text-victory-gold" />
          <div>
            <h3 class="font-bold text-foreground">تصنيف العشائر</h3>
            <p class="text-sm text-muted-foreground">أقوى العشائر والتحالفات</p>
          </div>
        </div>
      </a>
      
      <a href="/ar/rankings/seasonal" class="military-card p-4 hover:shadow-lg transition-shadow">
        <div class="flex items-center space-x-3 rtl:space-x-reverse">
          <Calendar size={32} class="text-orange-500" />
          <div>
            <h3 class="font-bold text-foreground">تصنيف الموسم</h3>
            <p class="text-sm text-muted-foreground">أفضل اللاعبين هذا الموسم</p>
          </div>
        </div>
      </a>
    </div>

    <!-- Global Leaderboard -->
    <div class="mb-12">
      <LeaderBoard 
        title="التصنيف العالمي"
        rankings={globalRankings}
        category="global"
        filters={leaderboardFilters}
        onPlayerClick={(id) => window.location.href = `/ar/players/${id}`}
        onFilterChange={(filters) => console.log('Filters changed:', filters)}
        onRefresh={() => window.location.reload()}
        showFilters={true}
        showSearch={true}
        maxEntries={50}
        client:load
      />
    </div>

    <!-- Tier Distribution -->
    <div class="military-card p-6 mb-8">
      <h2 class="text-xl font-bold text-foreground mb-4">توزيع الفئات</h2>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
        <div class="text-center p-4 bg-purple-500/20 rounded-lg">
          <div class="text-purple-500 text-2xl font-bold mb-1">25</div>
          <div class="text-sm text-muted-foreground">Legend</div>
          <div class="text-xs text-muted-foreground">0.16%</div>
        </div>
        <div class="text-center p-4 bg-red-500/20 rounded-lg">
          <div class="text-red-500 text-2xl font-bold mb-1">180</div>
          <div class="text-sm text-muted-foreground">Grandmaster</div>
          <div class="text-xs text-muted-foreground">1.14%</div>
        </div>
        <div class="text-center p-4 bg-victory-gold/20 rounded-lg">
          <div class="text-victory-gold text-2xl font-bold mb-1">850</div>
          <div class="text-sm text-muted-foreground">Master</div>
          <div class="text-xs text-muted-foreground">5.36%</div>
        </div>
        <div class="text-center p-4 bg-cyan-500/20 rounded-lg">
          <div class="text-cyan-500 text-2xl font-bold mb-1">2,400</div>
          <div class="text-sm text-muted-foreground">Diamond</div>
          <div class="text-xs text-muted-foreground">15.14%</div>
        </div>
        <div class="text-center p-4 bg-emerald-500/20 rounded-lg">
          <div class="text-emerald-500 text-2xl font-bold mb-1">4,200</div>
          <div class="text-sm text-muted-foreground">Platinum</div>
          <div class="text-xs text-muted-foreground">26.51%</div>
        </div>
        <div class="text-center p-4 bg-yellow-500/20 rounded-lg">
          <div class="text-yellow-500 text-2xl font-bold mb-1">5,800</div>
          <div class="text-sm text-muted-foreground">Gold</div>
          <div class="text-xs text-muted-foreground">36.59%</div>
        </div>
        <div class="text-center p-4 bg-gray-400/20 rounded-lg">
          <div class="text-gray-400 text-2xl font-bold mb-1">1,900</div>
          <div class="text-sm text-muted-foreground">Silver</div>
          <div class="text-xs text-muted-foreground">11.99%</div>
        </div>
        <div class="text-center p-4 bg-amber-600/20 rounded-lg">
          <div class="text-amber-600 text-2xl font-bold mb-1">492</div>
          <div class="text-sm text-muted-foreground">Bronze</div>
          <div class="text-xs text-muted-foreground">3.10%</div>
        </div>
      </div>
    </div>

    <!-- Ranking System Info -->
    <div class="military-card p-6">
      <h2 class="text-xl font-bold text-foreground mb-4">نظام التصنيف</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 class="font-semibold text-foreground mb-3">كيف يعمل التصنيف؟</h3>
          <div class="space-y-3 text-sm">
            <div class="flex items-start space-x-3 rtl:space-x-reverse">
              <div class="w-6 h-6 bg-tactical-green/20 text-tactical-green rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-xs font-bold">1</span>
              </div>
              <div>
                <p class="font-medium text-foreground">نقاط التقييم</p>
                <p class="text-muted-foreground">تحصل على نقاط عند الفوز وتخسر عند الهزيمة</p>
              </div>
            </div>
            <div class="flex items-start space-x-3 rtl:space-x-reverse">
              <div class="w-6 h-6 bg-command-blue/20 text-command-blue rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-xs font-bold">2</span>
              </div>
              <div>
                <p class="font-medium text-foreground">الفئات</p>
                <p class="text-muted-foreground">تنقسم إلى 8 فئات من البرونز إلى الأسطورة</p>
              </div>
            </div>
            <div class="flex items-start space-x-3 rtl:space-x-reverse">
              <div class="w-6 h-6 bg-victory-gold/20 text-victory-gold rounded-full flex items-center justify-center flex-shrink-0">
                <span class="text-xs font-bold">3</span>
              </div>
              <div>
                <p class="font-medium text-foreground">التحديث</p>
                <p class="text-muted-foreground">يتم تحديث التصنيف كل 10 دقائق</p>
              </div>
            </div>
          </div>
        </div>
        
        <div>
          <h3 class="font-semibold text-foreground mb-3">نصائح لتحسين ترتيبك</h3>
          <div class="space-y-3 text-sm">
            <div class="flex items-start space-x-3 rtl:space-x-reverse">
              <Star size={16} class="text-tactical-green mt-1 flex-shrink-0" />
              <div>
                <p class="font-medium text-foreground">العب بانتظام</p>
                <p class="text-muted-foreground">النشاط المستمر يحسن من ترتيبك</p>
              </div>
            </div>
            <div class="flex items-start space-x-3 rtl:space-x-reverse">
              <Star size={16} class="text-command-blue mt-1 flex-shrink-0" />
              <div>
                <p class="font-medium text-foreground">تعلم من الخبراء</p>
                <p class="text-muted-foreground">شاهد الريبلايز والفيديوهات التعليمية</p>
              </div>
            </div>
            <div class="flex items-start space-x-3 rtl:space-x-reverse">
              <Star size={16} class="text-victory-gold mt-1 flex-shrink-0" />
              <div>
                <p class="font-medium text-foreground">انضم لعشيرة</p>
                <p class="text-muted-foreground">العشائر تساعد في التحسن والتعلم</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</BaseLayout> 