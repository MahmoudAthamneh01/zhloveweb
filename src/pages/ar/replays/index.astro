---
import BaseLayout from '../../../layouts/BaseLayout.astro';
import ReplayCard from '../../../components/replays/ReplayCard.tsx';
import { Play, Plus, Search, Filter, Star, Trophy, Eye, Clock, Upload } from 'lucide-react';

const title = "الريبلايز - زد اتش لوف";
const description = "تصفح وشاهد أفضل مباريات الجنرالات زيرو آور من اللاعبين المحترفين";

// Mock replays data
const featuredReplays = [
  {
    id: 1,
    title: "نهائي البطولة العربية 2024 - ملحمة استراتيجية",
    description: "مباراة نهائية مذهلة بين أفضل لاعبين في الشرق الأوسط مع تكتيكات متقدمة ومناورات رائعة",
    uploadedAt: '2024-01-15T20:30:00Z',
    uploadedBy: {
      id: 1,
      username: 'سلطان_الحرب',
      avatar: '/avatars/sultan.png',
      verified: true
    },
    gameInfo: {
      map: 'Tournament Desert',
      mode: 'tournament',
      duration: 2450, // 40 minutes 50 seconds
      players: [
        {
          id: 1,
          username: 'سلطان_الحرب',
          faction: 'USA',
          result: 'win',
          score: 15420,
          isAI: false
        },
        {
          id: 2,
          username: 'أسد_الصحراء',
          faction: 'China',
          result: 'lose',
          score: 14780,
          isAI: false
        }
      ],
      winner: {
        id: 1,
        username: 'سلطان_الحرب'
      }
    },
    stats: {
      views: 25680,
      downloads: 1240,
      rating: 4.8,
      totalRatings: 456,
      featured: true
    },
    tags: ['tournament', 'final', 'pro', 'strategy'],
    category: 'tournament',
    quality: 'HD',
    fileSize: 89.5,
    version: '1.04',
    language: 'ar',
    thumbnail: '/thumbnails/replay1.jpg',
    isApproved: true,
    isFeatured: true,
    hasComments: true,
    commentCount: 89
  },
  {
    id: 2,
    title: "تكتيكات GLA المتقدمة - درس في الاستراتيجية",
    description: "تعلم كيفية استخدام تكتيكات GLA المتقدمة للفوز ضد الخصوم الأقوياء",
    uploadedAt: '2024-01-14T16:15:00Z',
    uploadedBy: {
      id: 2,
      username: 'محارب_الظلام',
      avatar: '/avatars/warrior.png',
      verified: true
    },
    gameInfo: {
      map: 'Urban Warfare',
      mode: 'multiplayer',
      duration: 1890, // 31 minutes 30 seconds
      players: [
        {
          id: 2,
          username: 'محارب_الظلام',
          faction: 'GLA',
          result: 'win',
          score: 12560,
          isAI: false
        },
        {
          id: 3,
          username: 'DragonFlame',
          faction: 'China',
          result: 'lose',
          score: 11240,
          isAI: false
        }
      ]
    },
    stats: {
      views: 18920,
      downloads: 892,
      rating: 4.6,
      totalRatings: 234,
      featured: false
    },
    tags: ['gla', 'strategy', 'tutorial', 'advanced'],
    category: 'training',
    quality: 'HD',
    fileSize: 67.2,
    version: '1.04',
    language: 'ar',
    thumbnail: '/thumbnails/replay2.jpg',
    isApproved: true,
    isFeatured: false,
    hasComments: true,
    commentCount: 45
  }
];

const allReplays = [
  ...featuredReplays,
  {
    id: 3,
    title: "معركة الدبابات الملحمية - USA vs China",
    description: "معركة دبابات ضخمة مع تشكيلات عسكرية متقدمة",
    uploadedAt: '2024-01-13T14:20:00Z',
    uploadedBy: {
      id: 3,
      username: 'قائد_المعركة',
      avatar: '/avatars/commander.png',
      verified: false
    },
    gameInfo: {
      map: 'Desert Fury',
      mode: 'skirmish',
      duration: 2150,
      players: [
        {
          id: 3,
          username: 'قائد_المعركة',
          faction: 'USA',
          result: 'win',
          score: 18950,
          isAI: false
        },
        {
          id: 4,
          username: 'AI_Hard',
          faction: 'China',
          result: 'lose',
          score: 16780,
          isAI: true
        }
      ]
    },
    stats: {
      views: 12450,
      downloads: 580,
      rating: 4.3,
      totalRatings: 145,
      featured: false
    },
    tags: ['tanks', 'epic', 'usa', 'china'],
    category: 'showcase',
    quality: 'Standard',
    fileSize: 52.1,
    version: '1.04',
    language: 'ar',
    thumbnail: '/thumbnails/replay3.jpg',
    isApproved: true,
    isFeatured: false,
    hasComments: true,
    commentCount: 23
  }
];

const replayStats = {
  totalReplays: 1248,
  featuredReplays: 24,
  newToday: 12,
  totalViews: 2580000,
  averageRating: 4.2
};
---

<BaseLayout title={title} description={description}>
  <div class="container-custom py-8">
    <!-- Header -->
    <div class="flex items-center justify-between mb-8">
      <div>
        <h1 class="text-3xl font-bold text-foreground mb-2 flex items-center space-x-3 rtl:space-x-reverse">
          <Play size={32} class="text-tactical-green" />
          <span>الريبلايز</span>
        </h1>
        <p class="text-muted-foreground">تصفح وشاهد أفضل مباريات الجنرالات زيرو آور</p>
      </div>
      <a href="/ar/replays/upload" class="btn btn-primary flex items-center space-x-2 rtl:space-x-reverse">
        <Upload size={20} />
        <span>رفع ريبلاي</span>
      </a>
    </div>

    <!-- Statistics -->
    <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-8">
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-tactical-green mb-1">{replayStats.totalReplays}</div>
        <div class="text-sm text-muted-foreground">ريبلاي</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-victory-gold mb-1">{replayStats.featuredReplays}</div>
        <div class="text-sm text-muted-foreground">مميز</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-command-blue mb-1">{replayStats.newToday}</div>
        <div class="text-sm text-muted-foreground">جديد اليوم</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-neutral-silver mb-1">{(replayStats.totalViews / 1000000).toFixed(1)}M</div>
        <div class="text-sm text-muted-foreground">مشاهدة</div>
      </div>
      <div class="military-card p-4 text-center">
        <div class="text-2xl font-bold text-orange-500 mb-1">{replayStats.averageRating}</div>
        <div class="text-sm text-muted-foreground">متوسط التقييم</div>
      </div>
    </div>

    <!-- Search and Filter -->
    <div class="military-card p-4 mb-8">
      <div class="flex flex-col lg:flex-row gap-4">
        <div class="flex-1 relative">
          <Search class="absolute left-3 rtl:right-3 rtl:left-auto top-1/2 transform -translate-y-1/2 text-muted-foreground" size={20} />
          <input
            type="text"
            placeholder="البحث في الريبلايز..."
            class="w-full pl-10 rtl:pr-10 rtl:pl-3 pr-3 py-2 bg-input border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-ring"
          />
        </div>
        
        <div class="flex flex-wrap items-center gap-2">
          <div class="flex items-center space-x-2 rtl:space-x-reverse">
            <Filter size={20} class="text-muted-foreground" />
            <select class="bg-input border border-border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring">
              <option value="">جميع الفئات</option>
              <option value="tournament">بطولة</option>
              <option value="training">تدريب</option>
              <option value="showcase">عرض</option>
              <option value="funny">مضحك</option>
              <option value="epic">ملحمي</option>
            </select>
          </div>
          
          <select class="bg-input border border-border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring">
            <option value="">جميع الفصائل</option>
            <option value="usa">USA</option>
            <option value="china">China</option>
            <option value="gla">GLA</option>
          </select>
          
          <select class="bg-input border border-border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring">
            <option value="">جميع الأوقات</option>
            <option value="today">اليوم</option>
            <option value="week">هذا الأسبوع</option>
            <option value="month">هذا الشهر</option>
            <option value="year">هذا العام</option>
          </select>
          
          <select class="bg-input border border-border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-ring">
            <option value="newest">الأحدث</option>
            <option value="popular">الأكثر شعبية</option>
            <option value="rating">الأعلى تقييماً</option>
            <option value="views">الأكثر مشاهدة</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Featured Replays -->
    <section class="mb-12">
      <h2 class="text-2xl font-bold text-foreground mb-6 flex items-center space-x-2 rtl:space-x-reverse">
        <Trophy size={24} class="text-victory-gold" />
        <span>الريبلايز المميزة</span>
      </h2>
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {featuredReplays.map(replay => (
          <ReplayCard 
            replay={replay}
            onPlay={(id) => window.location.href = `/ar/replays/${id}`}
            onDownload={(id) => console.log('Download replay:', id)}
            onRate={(id, rating) => console.log('Rate replay:', id, rating)}
            onFlag={(id) => console.log('Flag replay:', id)}
            currentUserId={1}
            isCompact={false}
            showActions={true}
            client:load
          />
        ))}
      </div>
    </section>

    <!-- Categories -->
    <section class="mb-12">
      <h2 class="text-2xl font-bold text-foreground mb-6">تصفح حسب الفئة</h2>
      <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
        <a href="/ar/replays?category=tournament" class="military-card p-4 text-center hover:shadow-lg transition-shadow">
          <div class="text-3xl mb-2">🏆</div>
          <div class="font-medium text-foreground">بطولات</div>
          <div class="text-sm text-muted-foreground">156 ريبلاي</div>
        </a>
        <a href="/ar/replays?category=training" class="military-card p-4 text-center hover:shadow-lg transition-shadow">
          <div class="text-3xl mb-2">🎯</div>
          <div class="font-medium text-foreground">تدريب</div>
          <div class="text-sm text-muted-foreground">342 ريبلاي</div>
        </a>
        <a href="/ar/replays?category=showcase" class="military-card p-4 text-center hover:shadow-lg transition-shadow">
          <div class="text-3xl mb-2">⭐</div>
          <div class="font-medium text-foreground">عرض</div>
          <div class="text-sm text-muted-foreground">689 ريبلاي</div>
        </a>
        <a href="/ar/replays?category=funny" class="military-card p-4 text-center hover:shadow-lg transition-shadow">
          <div class="text-3xl mb-2">😄</div>
          <div class="font-medium text-foreground">مضحك</div>
          <div class="text-sm text-muted-foreground">98 ريبلاي</div>
        </a>
        <a href="/ar/replays?category=epic" class="military-card p-4 text-center hover:shadow-lg transition-shadow">
          <div class="text-3xl mb-2">🔥</div>
          <div class="font-medium text-foreground">ملحمي</div>
          <div class="text-sm text-muted-foreground">124 ريبلاي</div>
        </a>
      </div>
    </section>

    <!-- Latest Replays -->
    <section class="mb-12">
      <h2 class="text-2xl font-bold text-foreground mb-6 flex items-center space-x-2 rtl:space-x-reverse">
        <Clock size={24} class="text-command-blue" />
        <span>أحدث الريبلايز</span>
      </h2>
      <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
        {allReplays.map(replay => (
          <ReplayCard 
            replay={replay}
            onPlay={(id) => window.location.href = `/ar/replays/${id}`}
            onDownload={(id) => console.log('Download replay:', id)}
            onRate={(id, rating) => console.log('Rate replay:', id, rating)}
            onFlag={(id) => console.log('Flag replay:', id)}
            currentUserId={1}
            isCompact={true}
            showActions={true}
            client:load
          />
        ))}
      </div>
    </section>

    <!-- Tips Section -->
    <section class="military-card p-6">
      <h2 class="text-xl font-bold text-foreground mb-4">نصائح لمشاهدة الريبلايز</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="space-y-4">
          <div class="flex items-start space-x-3 rtl:space-x-reverse">
            <div class="w-8 h-8 bg-tactical-green/20 text-tactical-green rounded-full flex items-center justify-center flex-shrink-0">
              <span class="text-sm font-bold">1</span>
            </div>
            <div>
              <h3 class="font-semibold text-foreground mb-1">تعلم من المحترفين</h3>
              <p class="text-sm text-muted-foreground">شاهد كيف يلعب أفضل اللاعبين وتعلم استراتيجياتهم</p>
            </div>
          </div>
          <div class="flex items-start space-x-3 rtl:space-x-reverse">
            <div class="w-8 h-8 bg-victory-gold/20 text-victory-gold rounded-full flex items-center justify-center flex-shrink-0">
              <span class="text-sm font-bold">2</span>
            </div>
            <div>
              <h3 class="font-semibold text-foreground mb-1">ادرس التكتيكات</h3>
              <p class="text-sm text-muted-foreground">انتبه للتكتيكات المختلفة وكيفية تطبيقها</p>
            </div>
          </div>
        </div>
        <div class="space-y-4">
          <div class="flex items-start space-x-3 rtl:space-x-reverse">
            <div class="w-8 h-8 bg-command-blue/20 text-command-blue rounded-full flex items-center justify-center flex-shrink-0">
              <span class="text-sm font-bold">3</span>
            </div>
            <div>
              <h3 class="font-semibold text-foreground mb-1">شارك تجربتك</h3>
              <p class="text-sm text-muted-foreground">قيّم الريبلايز واكتب تعليقات مفيدة</p>
            </div>
          </div>
          <div class="flex items-start space-x-3 rtl:space-x-reverse">
            <div class="w-8 h-8 bg-neutral-silver/20 text-neutral-silver rounded-full flex items-center justify-center flex-shrink-0">
              <span class="text-sm font-bold">4</span>
            </div>
            <div>
              <h3 class="font-semibold text-foreground mb-1">احفظ المفضلة</h3>
              <p class="text-sm text-muted-foreground">حمّل الريبلايز المفيدة لمراجعتها لاحقاً</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</BaseLayout> 