---
import BaseLayout from '../../layouts/BaseLayout.astro';
import TournamentCard from '../../components/tournaments/TournamentCard';
import TournamentManagement from '../../components/tournaments/TournamentManagement';
---

<BaseLayout 
  title="Ø¨Ø·ÙˆÙ„Ø§ØªÙŠ - ZH-Love"
  description="Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„ØªÙŠ Ø£Ø´Ø§Ø±Ùƒ ÙÙŠÙ‡Ø§ ÙˆØ£Ù†Ø¸Ù…Ù‡Ø§"
>
  <div class="min-h-screen bg-background">
    <!-- Hero Section -->
    <div class="relative bg-gradient-to-r from-gray-900 via-purple-900 to-gray-900 py-16">
      <div class="absolute inset-0 bg-black opacity-50"></div>
      
      <div class="relative container mx-auto px-4">
        <div class="text-center">
          <h1 class="text-4xl font-bold text-white mb-4">
            <span class="bg-gradient-to-r from-purple-400 via-blue-400 to-purple-400 bg-clip-text text-transparent">
              ğŸ† Ø¨Ø·ÙˆÙ„Ø§ØªÙŠ
            </span>
          </h1>
          <p class="text-xl text-gray-300 mb-6 max-w-2xl mx-auto">
            Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„ØªÙŠ ØªÙ†Ø¸Ù…Ù‡Ø§ ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
          </p>
        </div>
      </div>
    </div>

    <div class="container mx-auto px-4 py-12">
      <!-- Navigation Tabs -->
      <div class="bg-card border border-border rounded-lg mb-8">
        <nav class="flex overflow-x-auto">
          <button 
            id="tab-participating" 
            class="tab-button active flex items-center space-x-2 rtl:space-x-reverse px-6 py-4 font-medium transition-colors whitespace-nowrap"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
            </svg>
            <span>Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ ÙÙŠÙ‡Ø§</span>
            <span id="participating-count" class="bg-blue-600 text-white text-xs rounded-full px-2 py-1">0</span>
          </button>
          
          <button 
            id="tab-organizing" 
            class="tab-button flex items-center space-x-2 rtl:space-x-reverse px-6 py-4 font-medium transition-colors whitespace-nowrap"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
            </svg>
            <span>Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„ØªÙŠ Ø£Ù†Ø¸Ù…Ù‡Ø§</span>
            <span id="organizing-count" class="bg-green-600 text-white text-xs rounded-full px-2 py-1">0</span>
          </button>
          
          <button 
            id="tab-applications" 
            class="tab-button flex items-center space-x-2 rtl:space-x-reverse px-6 py-4 font-medium transition-colors whitespace-nowrap"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
            </svg>
            <span>Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</span>
            <span id="applications-count" class="bg-yellow-600 text-white text-xs rounded-full px-2 py-1">0</span>
          </button>
          
          <button 
            id="tab-management" 
            class="tab-button flex items-center space-x-2 rtl:space-x-reverse px-6 py-4 font-medium transition-colors whitespace-nowrap"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            </svg>
            <span>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª</span>
          </button>
        </nav>
      </div>

      <!-- Tab Content -->
      <div id="tab-content">
        <!-- Participating Tournaments -->
        <div id="content-participating" class="tab-content active">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-white mb-4">Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ ÙÙŠÙ‡Ø§</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
              <div class="bg-card border border-border rounded-lg p-4 text-center">
                <div class="text-2xl font-bold text-blue-400" id="stats-active">0</div>
                <div class="text-gray-400">Ø¨Ø·ÙˆÙ„Ø§Øª Ù†Ø´Ø·Ø©</div>
              </div>
              <div class="bg-card border border-border rounded-lg p-4 text-center">
                <div class="text-2xl font-bold text-green-400" id="stats-completed">0</div>
                <div class="text-gray-400">Ù…ÙƒØªÙ…Ù„Ø©</div>
              </div>
              <div class="bg-card border border-border rounded-lg p-4 text-center">
                <div class="text-2xl font-bold text-yellow-400" id="stats-wins">0</div>
                <div class="text-gray-400">Ø§Ù†ØªØµØ§Ø±Ø§Øª</div>
              </div>
              <div class="bg-card border border-border rounded-lg p-4 text-center">
                <div class="text-2xl font-bold text-purple-400" id="stats-total-prize">$0</div>
                <div class="text-gray-400">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø²</div>
              </div>
            </div>
          </div>
          
          <div id="participating-tournaments" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Loading State -->
            <div class="col-span-full flex items-center justify-center py-20">
              <div class="text-center">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-4"></div>
                <p class="text-gray-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Organizing Tournaments -->
        <div id="content-organizing" class="tab-content">
          <div class="flex items-center justify-between mb-6">
            <h2 class="text-2xl font-bold text-white">Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„ØªÙŠ Ø£Ù†Ø¸Ù…Ù‡Ø§</h2>
            <a href="/ar/tournaments" class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center space-x-2 rtl:space-x-reverse">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
              </svg>
              <span>Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©</span>
            </a>
          </div>
          
          <div id="organizing-tournaments" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Loading State -->
            <div class="col-span-full flex items-center justify-center py-20">
              <div class="text-center">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mb-4"></div>
                <p class="text-gray-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Applications -->
        <div id="content-applications" class="tab-content">
          <div class="mb-6">
            <h2 class="text-2xl font-bold text-white mb-4">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù…</h2>
            <div class="bg-blue-900/20 border border-blue-500/30 rounded-lg p-4 mb-6">
              <div class="flex items-center space-x-3 rtl:space-x-reverse">
                <svg class="w-5 h-5 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="text-blue-300">Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… ÙŠØ¹Ø±Ø¶ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„ØªÙŠ ØªÙ†Ø¸Ù…Ù‡Ø§</span>
              </div>
            </div>
          </div>
          
          <div id="applications-list" class="space-y-4">
            <!-- Applications will be loaded here -->
          </div>
        </div>

        <!-- Management -->
        <div id="content-management" class="tab-content">
          <TournamentManagement client:load />
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      let currentTab = 'participating';
      let userTournaments = {
        participating: [],
        organizing: [],
        applications: []
      };

      // Initialize page
      checkAuth();
      setupTabs();
      loadUserTournaments();

      function checkAuth() {
        const token = localStorage.getItem('zh_love_token');
        if (!token) {
          window.location.href = '/ar/login';
          return;
        }
      }

      function setupTabs() {
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        tabButtons.forEach(button => {
          button.addEventListener('click', function() {
            const tabId = this.id.replace('tab-', '');
            switchTab(tabId);
          });
        });
      }

      function switchTab(tabId) {
        // Update active states
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
        
        document.getElementById(`tab-${tabId}`).classList.add('active');
        document.getElementById(`content-${tabId}`).classList.add('active');
        
        currentTab = tabId;
        
        // Load specific content
        if (tabId === 'management') {
          loadManagement();
        }
      }

      async function loadUserTournaments() {
        try {
          const token = localStorage.getItem('zh_love_token');
          
          // Load participating tournaments
          await loadParticipatingTournaments();
          
          // Load organizing tournaments
          await loadOrganizingTournaments();
          
          // Load applications
          await loadApplications();
          
          updateCounts();
          
        } catch (error) {
          console.error('Error loading user tournaments:', error);
        }
      }

      async function loadParticipatingTournaments() {
        try {
          // For now, use mock data
          const mockTournaments = [
            {
              id: 1,
              name: 'Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ø¬Ù†Ø±Ø§Ù„Ø§Øª Ø§Ù„ÙƒØ¨Ø±Ù‰ 2024',
              description: 'Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ø£ÙƒØ¨Ø± ÙˆØ§Ù„Ø£Ù‡Ù… ÙÙŠ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø¹Ø±Ø¨ÙŠ',
              status: 'live',
              participants: 89,
              maxParticipants: 128,
              prizePool: 2500,
              startDate: '2024-03-15T18:00:00',
              myPosition: null,
              isEliminated: false
            }
          ];
          
          userTournaments.participating = mockTournaments;
          displayParticipatingTournaments();
          updateParticipationStats();
          
        } catch (error) {
          console.error('Error loading participating tournaments:', error);
        }
      }

      async function loadOrganizingTournaments() {
        try {
          // Get current user
          const currentUser = JSON.parse(localStorage.getItem('zh_love_user') || '{}');
          
          // Load from localStorage (user created tournaments)
          const localTournaments = JSON.parse(localStorage.getItem('user_tournaments') || '[]');
          
          // Filter tournaments created by current user only
          userTournaments.organizing = localTournaments.filter(tournament => 
            tournament.organizerId === currentUser.id || 
            tournament.organizerName === currentUser.username
          );
          
          displayOrganizingTournaments();
          
        } catch (error) {
          console.error('Error loading organizing tournaments:', error);
        }
      }

      async function loadApplications() {
        try {
          // Mock applications data
          const mockApplications = [];
          userTournaments.applications = mockApplications;
          displayApplications();
          
        } catch (error) {
          console.error('Error loading applications:', error);
        }
      }

      function displayParticipatingTournaments() {
        const container = document.getElementById('participating-tournaments');
        
        if (userTournaments.participating.length === 0) {
          container.innerHTML = `
            <div class="col-span-full text-center py-12">
              <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
              </svg>
              <h3 class="text-xl font-semibold text-white mb-2">Ù„Ù… ØªØ´Ø§Ø±Ùƒ ÙÙŠ Ø£ÙŠ Ø¨Ø·ÙˆÙ„Ø© Ø¨Ø¹Ø¯</h3>
              <p class="text-gray-400 mb-4">Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø«ÙŠØ±Ø© ÙˆØ§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ‡Ø§</p>
              <a href="/ar/tournaments" class="px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                ØªØµÙØ­ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø§Øª
              </a>
            </div>
          `;
          return;
        }

        container.innerHTML = userTournaments.participating.map(tournament => `
          <div class="bg-card border border-border rounded-lg overflow-hidden hover:shadow-lg transition-all">
            <div class="p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold text-white">${tournament.name}</h3>
                <span class="px-3 py-1 text-xs font-bold rounded-full ${getStatusColor(tournament.status)}">
                  ${getStatusText(tournament.status)}
                </span>
              </div>
              
              <p class="text-gray-400 text-sm mb-4">${tournament.description}</p>
              
              <div class="grid grid-cols-2 gap-4 mb-4 text-sm">
                <div class="flex items-center justify-between">
                  <span class="text-gray-400">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†:</span>
                  <span class="text-white">${tournament.participants}/${tournament.maxParticipants}</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-400">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©:</span>
                  <span class="text-yellow-400">$${tournament.prizePool}</span>
                </div>
              </div>
              
              ${tournament.myPosition ? `
                <div class="bg-green-900/20 border border-green-500/30 rounded-lg p-3 mb-4">
                  <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <svg class="w-4 h-4 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                    </svg>
                    <span class="text-green-300 font-medium">Ø§Ù„Ù…Ø±ÙƒØ² ${tournament.myPosition}</span>
                  </div>
                </div>
              ` : ''}
              
              ${tournament.isEliminated ? `
                <div class="bg-red-900/20 border border-red-500/30 rounded-lg p-3 mb-4">
                  <span class="text-red-300">Ø®Ø±Ø¬Øª Ù…Ù† Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©</span>
                </div>
              ` : ''}
              
              <div class="flex space-x-3 rtl:space-x-reverse">
                <button onclick="viewTournament(${tournament.id})" class="flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm">
                  Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                </button>
                ${tournament.status === 'live' ? `
                  <button onclick="watchLive(${tournament.id})" class="flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm">
                    Ù…Ø´Ø§Ù‡Ø¯Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
                  </button>
                ` : ''}
              </div>
            </div>
          </div>
        `).join('');
      }

      function displayOrganizingTournaments() {
        const container = document.getElementById('organizing-tournaments');
        
        if (userTournaments.organizing.length === 0) {
          container.innerHTML = `
            <div class="col-span-full text-center py-12">
              <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
              </svg>
              <h3 class="text-xl font-semibold text-white mb-2">Ù„Ù… ØªÙ†Ø´Ø¦ Ø£ÙŠ Ø¨Ø·ÙˆÙ„Ø© Ø¨Ø¹Ø¯</h3>
              <p class="text-gray-400 mb-4">Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·ÙˆÙ„ØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰</p>
              <a href="/ar/tournaments" class="px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors">
                Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©
              </a>
            </div>
          `;
          return;
        }

        container.innerHTML = userTournaments.organizing.map(tournament => `
          <div class="bg-card border border-border rounded-lg overflow-hidden hover:shadow-lg transition-all">
            <div class="p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-bold text-white">${tournament.name}</h3>
                <div class="flex items-center space-x-2 rtl:space-x-reverse">
                  ${tournament.isFeatured ? '<span class="px-2 py-1 bg-yellow-600 text-white text-xs rounded-full">Ù…Ù…ÙŠØ²Ø©</span>' : ''}
                  <span class="px-3 py-1 text-xs font-bold rounded-full ${getStatusColor(tournament.status)}">
                    ${getStatusText(tournament.status)}
                  </span>
                </div>
              </div>
              
              <p class="text-gray-400 text-sm mb-4">${tournament.description}</p>
              
              <div class="grid grid-cols-2 gap-4 mb-4 text-sm">
                <div class="flex items-center justify-between">
                  <span class="text-gray-400">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙŠÙ†:</span>
                  <span class="text-white">${tournament.participants || 0}/${tournament.maxParticipants}</span>
                </div>
                <div class="flex items-center justify-between">
                  <span class="text-gray-400">Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©:</span>
                  <span class="text-yellow-400">$${tournament.prizePool}</span>
                </div>
              </div>
              
              <div class="flex space-x-3 rtl:space-x-reverse">
                <button onclick="manageTournament(${tournament.id})" class="flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors text-sm">
                  Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©
                </button>
                <button onclick="viewTournament(${tournament.id})" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm">
                  Ø¹Ø±Ø¶
                </button>
              </div>
            </div>
          </div>
        `).join('');
      }

      function displayApplications() {
        const container = document.getElementById('applications-list');
        
        if (userTournaments.applications.length === 0) {
          container.innerHTML = `
            <div class="text-center py-12">
              <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
              </svg>
              <h3 class="text-xl font-semibold text-white mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø§Ù†Ø¶Ù…Ø§Ù…</h3>
              <p class="text-gray-400">Ø¹Ù†Ø¯Ù…Ø§ ØªÙ†Ø´Ø¦ Ø¨Ø·ÙˆÙ„Ø§Øª Ø³ØªØ¸Ù‡Ø± Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù‡Ù†Ø§</p>
            </div>
          `;
          return;
        }

        // Display applications
        container.innerHTML = userTournaments.applications.map(application => `
          <!-- Application card would go here -->
        `).join('');
      }

      function updateCounts() {
        document.getElementById('participating-count').textContent = userTournaments.participating.length;
        document.getElementById('organizing-count').textContent = userTournaments.organizing.length;
        document.getElementById('applications-count').textContent = userTournaments.applications.length;
      }

      function updateParticipationStats() {
        const activeTournaments = userTournaments.participating.filter(t => t.status === 'live' || t.status === 'open').length;
        const completedTournaments = userTournaments.participating.filter(t => t.status === 'completed').length;
        const wins = userTournaments.participating.filter(t => t.myPosition === 1).length;
        const totalPrize = userTournaments.participating.reduce((sum, t) => sum + (t.myPosition === 1 ? t.prizePool : 0), 0);

        document.getElementById('stats-active').textContent = activeTournaments;
        document.getElementById('stats-completed').textContent = completedTournaments;
        document.getElementById('stats-wins').textContent = wins;
        document.getElementById('stats-total-prize').textContent = `$${totalPrize}`;
      }

      function loadManagement() {
        // Load tournament management for organizing tournaments
        if (userTournaments.organizing.length > 0) {
          const firstTournament = userTournaments.organizing[0];
          window.dispatchEvent(new CustomEvent('loadTournamentManagement', {
            detail: { tournament: firstTournament }
          }));
        }
      }

      function getStatusColor(status) {
        switch (status) {
          case 'open': return 'bg-green-600 text-white';
          case 'live': return 'bg-red-600 text-white animate-pulse';
          case 'completed': return 'bg-gray-600 text-white';
          case 'upcoming': return 'bg-blue-600 text-white';
          case 'cancelled': return 'bg-red-800 text-white';
          default: return 'bg-gray-600 text-white';
        }
      }

      function getStatusText(status) {
        switch (status) {
          case 'open': return 'Ù…ÙØªÙˆØ­ Ù„Ù„ØªØ³Ø¬ÙŠÙ„';
          case 'live': return 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¢Ù†';
          case 'completed': return 'Ù…Ù†ØªÙ‡ÙŠØ©';
          case 'upcoming': return 'Ù‚Ø±ÙŠØ¨Ø§Ù‹';
          case 'cancelled': return 'Ù…Ù„ØºÙŠØ©';
          default: return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }
      }

      // Global functions
      window.viewTournament = function(tournamentId) {
        window.location.href = `/ar/tournaments/${tournamentId}`;
      };

      window.manageTournament = function(tournamentId) {
        switchTab('management');
        loadManagement();
      };

      window.watchLive = function(tournamentId) {
        window.location.href = `/ar/tournaments/${tournamentId}/live`;
      };
    });
  </script>

  <style>
    .tab-button {
      @apply border-b-2 border-transparent text-gray-400;
    }
    
    .tab-button.active {
      @apply border-green-500 text-green-400 bg-green-900/10;
    }
    
    .tab-button:hover {
      @apply text-gray-300 bg-gray-800/50;
    }
    
    .tab-content {
      @apply hidden;
    }
    
    .tab-content.active {
      @apply block;
    }
  </style>
</BaseLayout> 